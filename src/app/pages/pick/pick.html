<section
  id="pick"
  class="w-full min-h-screen bg-linear-to-r from-brand-light-red to-brand-dark-red flex flex-col justify-center items-center"
>
  <div class="w-full max-w-7xl mx-auto flex flex-col items-center gap-15 text-brand-white">
    <p class="text-4xl font-bold">Take or Upload Your Ingredients</p>
    @if (!isCameraOpen() && !capturedImage()) {
      <div class="flex gap-8">
        <app-pick-button [icon]="faCamera" text="Take" (btnClick)="openCamera()"></app-pick-button>
        <app-pick-button
          [icon]="faImage"
          text="Upload"
          (btnClick)="fileInput.click()"
        ></app-pick-button>
        <input
          #fileInput
          type="file"
          accept="image/*"
          class="hidden"
          (change)="onFileSelected($event)"
        />
      </div>
    }
    <div [class.hidden]="!isCameraOpen()" class="relative flex flex-col items-center">
      <video
        #videoElement
        autoplay
        playsinline
        class="w-full max-w-md rounded-[2rem] border-4 border-brand-light-yellow shadow-2xl"
      ></video>
      <button
        (click)="takeSnapshot()"
        class="mt-4 bg-brand-light-yellow text-black px-8 py-3 rounded-full font-bold hover:scale-105 transition-all"
      >
        Take
      </button>
    </div>

    @if (capturedImage()) {
      <div class="flex flex-col items-center gap-4">
        <img
          [src]="capturedImage()"
          alt=""
          class="w-full max-w-md rounded-[2rem] border-2 border-white/50 shadow-lg"
        />
        <div class="flex gap-4">
          <button
            (click)="capturedImage.set(null); recipeResult.set(null)"
            class="text-white underline"
          >
            Ulangi
          </button>
          <button
            (click)="analyzeImage()"
            [disabled]="isLoading()"
            class="bg-green-500 text-white px-6 py-2 rounded-full font-bold"
          >
            {{ isLoading() ? 'Sedang Menganalisis...' : 'Analisis' }}
          </button>
        </div>
        @if (recipeResult()) {
          <div
            class="mt-6 p-6 bg-white/10 backdrop-blur-md rounded-[2rem] border border-white/20 text-left w-full max-w-md animate-fade-in"
          >
            <h3 class="text-xl font-bold mb-3 text-brand-light-yellow">Saran Resep Gemini:</h3>
            <p class="whitespace-pre-wrap leading-relaxed">{{ recipeResult() }}</p>
          </div>
        }
      </div>
    }
    <div class="text-center">
      <p class="font-bold">It only takes 3 steps:</p>
      <p>Check Ingredients -> Pick -> Enjoy</p>
      <p>Cooking becomes more relaxed without the constant 'what to cook' drama</p>
    </div>
  </div>
</section>
